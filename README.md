## 测试一下 kafka + Nest

# 本项目更多的是实践一下这个消息队列的消费流程

# 因为只是初步学习，所以都是现学现卖，缺少很多容错，健壮性欠佳
# 项目中的ip都是内网ip，就不修改成xx了，自己替换吧。

消息队列可以说是后端的进阶必备吧，并发增大之后，必须要去处理削峰的问题，否则应对服务很快就会瓶颈，服务崩溃，那么能够想到的直观方案就是通过消息队列去存储消息。
这样既可以保证前部的服务做到快速响应，将逻辑处理通过消息队列去解耦，一旦解耦，就可以通过增加消费者的方式来快速处理消息，加大吞吐量
又因为消息队列本身都有持久化方案，即便中间的消息出现异常，也能够做到重新消费，让服务健壮性更加的好，扩展性也更加好，比如新增加一些功能，可以通过消费旧的消息队列来快速应用。
几乎都是优点，缺点就是一致性，顺序性这些问题，根本就是并发的问题。

# 这个项目我主要就是想通过一系列的实验来帮助我学习消息队列

1. 主要就是使用了 nest 的微服务来做 kafka 的消息消费
2. 发现网络上相关的内容较少，而 nest 官网的介绍也很少，所以记录一下

# kafka 的部署

1. 我这边使用的 docker 来部署 kafka 集群
2. 因为暂时没有生产环境的项目，都是内网做的测试。生产环境的部署，必定是不同的。ssl+sasl 的版本，还在探索中

# 几点疑惑，希望有缘人可以给出一些学习建议

1. kafka 集群的扩容，尤其是生产环境，kafka 集群如何扩容，因为比如订单的消费，比如订单创建，处理，完成，具有强烈的顺序要求。看到某些方案中提到，让同一个订单的相关消息都同步到一个 partition 中，这样就可以保证消息的顺序消费。要做到这一步，需要确保每个 partition 对应一个 consumer，对于初次部署，这个方案一点问题没有，看着也很靠谱。但是我就产生了困惑，如果在生产环境做扩容，也就是说扩容 patition 同时也需要去扩容 consumer，同时还要保证服务不中断，如何做到？
